<%# model: @post と書くことで、Postモデル用のフォームだとRailsが判断してくれる %>
  <%= form_with model: post, local: true do |f| %>
    
    <div class="mb-2">
      <%# 入力欄（ターゲット）: data-character-count-target="input" %>
      <%# 入力するたびに動くアクション: data-action="input->character-count#count" %>
      <%= f.text_area :content, 
          class: "w-full border p-2 rounded", 
          placeholder: "ここに入力してね",
          rows: 3,
          data: { 
            character_count_target: "input", 
            action: "input->character-count#count" 
          } %>
      <!-- 1. コントローラーを紐付け -->
      <div class="mt-2" data-controller="image-preview">
        
        <!-- 2. ファイル選択ボタン -->
        <!-- data-image-preview-target="input" を追加（JSからファイルを取得するため） -->
        <!-- action: "change->..." を追加（選択が変わったら動かすため） -->
        <%= f.file_field :image, 
            class: "text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",
            data: { 
              image_preview_target: "input",
              action: "change->image-preview#preview" 
            } %>

        <!-- 3. プレビュー表示場所 -->
        <!-- 最初は何も表示しないので hidden クラスをつけておく -->
        <div class="mt-3">
          <img data-image-preview-target="output" class="rounded-lg max-h-60 object-cover hidden">
        </div>
        
      </div>
    </div>

    <!-- 文字数を表示する場所（ターゲット） -->
    <div class="text-right text-sm text-gray-500 mb-2">
      あと <span data-character-count-target="output">140</span> 文字
    </div>
    
    <!-- 変更前 -->
    <!-- <%= f.submit "投稿する", class: "btn-primary w-full" %> -->

    <!-- 変更後：ボタンを2つ並べる -->
    <div class="flex gap-2">
      <%# 公開ボタン：name属性に "published" をつける %>
      <%= f.button "公開する", name: "post[status]", value: "published", class: "btn-primary flex-1" %>
      
      <%# 下書きボタン：name属性に "draft" をつける %>
      <%# 色を変えるために btn-secondary (もし定義してれば) や bg-gray-500 を使用 %>
      <%= f.button "下書き保存", name: "post[status]", value: "draft", class: "bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded cursor-pointer flex-1" %>
    </div>
    
  <% end %>
</div>